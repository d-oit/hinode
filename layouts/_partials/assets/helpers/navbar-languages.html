{{- $page := .page -}}
{{- $baseURL := .baseURL -}}
{{- $breakpoint := .breakpoint -}}
{{- $pretty := .pretty -}}
{{- $icon := .icon | default "fas globe" -}}
{{- $fs := .fs | default 6 -}}
{{- $inline := site.Params.navigation.language.inline | default false -}}
{{- $class := cond $inline "inline-menu" "dropdown-menu dropdown-menu-end" }}

{{- $lang := $page.Language.Lang -}}
<li class="nav-item dropdown me-auto">
    {{ if not $inline }}
        <a class="nav-link dropdown-toggle d-{{ $breakpoint }}-none" role="button" data-bs-toggle="dropdown" 
            aria-label="{{ T "languageSwitcherLabel" }}" aria-expanded="false">
            {{- partial "assets/icon.html" (dict "icon" (printf "%s fa-fw" $icon) "spacing" true) }}{{ T "languageSwitcherLabel" }}
        </a>
        <a class="nav-link dropdown-toggle d-none d-{{ $breakpoint }}-block" role="button" data-bs-toggle="dropdown" 
            aria-label="{{ T "languageSwitcherLabel" }}" aria-expanded="false">
            {{- partial "assets/icon.html" (dict "icon" (printf "%s fa-fw" $icon) "spacing" false) }}
        </a>
    {{ end }}
    <ul id="language-selector" class="{{ $class }} navbar-fs-{{ $fs }} navbar-{{ $breakpoint }}-fs" data-translated="{{ $page.IsTranslated }}">
        {{- if $page.IsTranslated -}}
            {{- range $page.AllTranslations -}}
                <li>
                    {{- $state := cond (eq .Language.Lang $lang) "active" "" }}
                    <a class="dropdown-item {{ $state }}" hreflang="{{ .Language.Lang }}" href="{{ .RelPermalink }}">
                        {{- cond $inline (upper .Language.Lang) .Language.LanguageName -}}
                    </a>
                </li>
            {{- end -}}
        {{- else -}}
            {{- range site.Languages -}}
                <li>
                    {{- $state := cond (eq .Lang $lang) "active" "disabled" }}
                    <a class="dropdown-item {{ $state }}" href="{{ cond (eq $state "active") $page.RelPermalink "#!" }}" hreflang="{{ .Lang }}">
                    {{- cond $inline (upper .Lang) (default .Lang .LanguageName) -}}
                    </a>
                </li>
            {{- end -}}
        {{- end -}}
    </ul>
</li>